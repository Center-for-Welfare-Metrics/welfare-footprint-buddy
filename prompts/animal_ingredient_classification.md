# Animal Ingredient Classification Criteria

**Version:** 1.0  
**Last Updated:** 2025-01-21  
**Status:** Active  
**Subject to Scientific Review:** Yes

## Overview

This document defines the scientific and practical criteria for classifying ingredients as animal-derived or plant-based. Accurate ingredient classification is fundamental to welfare analysis, as it determines which products fall within the scope of animal welfare assessment.

---

## Purpose

These criteria serve to:
1. **Guide ingredient detection** - Provide clear rules for identifying animal-derived ingredients
2. **Maintain consistency** - Ensure uniform classification across products
3. **Support transparency** - Enable users to understand what counts as animal-derived
4. **Enable scientific review** - Allow validation of classification decisions

---

## Primary Animal-Derived Ingredients

### Definition
Ingredients where an animal (or animal-derived material) is the primary, intentional component of the ingredient.

### Categories

#### 1. Meat and Flesh
**Includes:**
- All muscle tissue from mammals, birds, fish, and other animals
- Processed meat products (sausage, bacon, ham, deli meat, etc.)
- Organ meats (liver, heart, kidney, etc.)
- Ground or minced meat products
- Meat extracts and concentrates

**Examples:**
- Beef, pork, lamb, chicken, turkey, duck, fish, shrimp, lobster, crab
- Anchovies, sardines, tuna
- Gelatin (derived from animal collagen)

**Classification:** Always animal-derived (High confidence when visible or labeled)

---

#### 2. Dairy Products
**Includes:**
- Milk from any mammal (cow, goat, sheep, buffalo, etc.)
- All dairy derivatives:
  - Cheese (all types)
  - Butter
  - Cream
  - Yogurt
  - Ice cream (unless explicitly plant-based)
  - Whey and whey protein
  - Casein and caseinates
  - Lactose
  - Milk powder/milk solids

**Examples:**
- Mozzarella, cheddar, parmesan, feta, cream cheese
- Whole milk, skim milk, condensed milk
- Buttermilk, sour cream

**Classification:** Always animal-derived (High confidence when labeled or visible)

**Special Cases:**
- Plant-based alternatives (almond milk, oat milk, vegan cheese) are NOT dairy
- "Lactose-free" dairy is still animal-derived
- "Non-dairy" labels can be misleading (may still contain casein)

---

#### 3. Eggs and Egg Products
**Includes:**
- Whole eggs (chicken, duck, quail, etc.)
- Egg whites (albumen)
- Egg yolks
- Processed egg products:
  - Liquid eggs
  - Powdered eggs
  - Egg albumin
  - Lecithin (when from eggs, though often from soy)

**Examples:**
- Fresh eggs, scrambled eggs, omelets
- Mayonnaise (contains eggs)
- Many baked goods (cakes, cookies, pasta)

**Classification:** Always animal-derived (High confidence when visible or labeled)

**Special Cases:**
- Plant-based egg alternatives (JUST Egg, etc.) are NOT animal-derived
- Lecithin is often from soy (plant-based), but can be from eggs (check source)

---

#### 4. Fish and Seafood
**Includes:**
- All fish species (finfish)
- Shellfish (crustaceans and mollusks)
- Cephalopods (squid, octopus)
- Fish products:
  - Fish sauce
  - Fish oil
  - Anchovies in Caesar dressing
  - Caviar (fish eggs)

**Examples:**
- Salmon, tuna, cod, tilapia, sardines
- Shrimp, crab, lobster, clams, mussels, oysters
- Squid, octopus

**Classification:** Always animal-derived (High confidence)

---

#### 5. Honey and Bee Products
**Includes:**
- Honey
- Beeswax (sometimes used in coatings or waxes)
- Royal jelly
- Propolis

**Classification:** Animal-derived (insect product)

**Note:** While some ethical frameworks consider honey less concerning than other animal products (no slaughter involved), it is still derived from live-animal use and falls under welfare footprint assessment.

---

#### 6. Other Animal-Derived Ingredients
**Includes:**
- Gelatin (from animal collagen; used in gummy candies, marshmallows, gel caps)
- Rennet (enzyme from calf stomach; used in cheese-making, though microbial rennet exists)
- Cochineal/Carmine (red dye from insects; E120)
- Shellac (insect secretion; used as coating on candy and pills)
- Isinglass (from fish bladders; used in beer/wine clarification)
- Lard (pork fat)
- Tallow (beef or mutton fat)
- Collagen (from animal connective tissue)

**Classification:** Animal-derived (confidence depends on visibility/labeling)

---

## Product Knowledge Inference

### High-Confidence Inferences

**When product categories have well-documented standard formulations, use HIGH confidence:**

#### Dairy-Containing Products
- **White chocolate ("Branco")** → ALWAYS contains dairy (milk powder)
- **Milk chocolate** → Contains dairy unless labeled "dark chocolate" or "vegan"
- **Standard yogurt** → Contains dairy unless labeled "plant-based"
- **Cheese products (all types)** → Always contain dairy
- **Ice cream** → Contains dairy unless labeled "plant-based" or "non-dairy"
- **Butter, cream, sour cream** → Always dairy

#### Egg-Containing Products
- **Mayonnaise** → Typically contains eggs (unless vegan)
- **Standard pasta** → Often contains eggs (especially fresh pasta)
- **Most cakes, cookies, muffins** → Typically contain eggs and dairy
- **Custard, pudding** → Typically contains eggs and dairy

#### Meat/Fish Products
- Labeled as "chicken", "beef", "fish", etc. → High confidence for meat content

---

### Medium-Confidence Inferences

**When formulations vary, use MEDIUM confidence:**

#### Variable Formulations
- **Bread products** → May or may not contain dairy/eggs (depends on type)
- **Dark chocolate** → Typically vegan, but some brands add milk as processing aid
- **Baked goods (general)** → Likely contain eggs and dairy, but vegan versions exist
- **Soup, sauces** → May contain hidden animal ingredients (stock, butter, cream)

---

### Low-Confidence Cases

**When insufficient information, use LOW confidence:**
- Ambiguous product without visible label
- Unusual or unfamiliar products
- Cannot determine formulation from image or name

---

## Trace Ingredients and Processing Aids

### Trace Animal Ingredients

**Definition:** Animal-derived ingredients present in very small amounts, often as processing aids or minor components.

**Examples:**
- Lactose as a processing aid in some medications
- Whey powder in some "reduced-fat" processed foods
- Gelatin in vitamin capsules
- Casein in some "non-dairy" products (misleading label)

**Classification:** Still animal-derived, but acknowledge quantity is minimal

**Communication:**
- Be transparent: "contains trace amounts of dairy (whey)"
- Note: "primarily plant-based with minor animal ingredients"

---

### Cross-Contamination vs. Intentional Ingredients

**Cross-Contamination (NOT counted as animal-derived):**
- "May contain milk" (allergy warning due to shared equipment)
- "Processed in facility that also processes eggs"

**Intentional Ingredients (COUNTED as animal-derived):**
- "Contains milk" (ingredient list)
- "Contains: eggs" (ingredient statement)

**Rule:** Only count intentionally added ingredients, not cross-contamination warnings.

---

## Special Cases

### Plant-Based Alternatives

**Products explicitly labeled as plant-based are NOT animal-derived:**
- Plant-based milk (almond, soy, oat, coconut milk)
- Vegan cheese, vegan butter, vegan yogurt
- Plant-based meat alternatives (Beyond Meat, Impossible Foods)
- Egg alternatives (JUST Egg, aquafaba-based products)

**Classification:** Plant-based (no animal welfare concern)

**Confidence:** High (when labeled explicitly)

---

### Organic, Cage-Free, Free-Range Labels

**CRITICAL:** These labels indicate production METHOD, NOT ingredient composition.

**Examples:**
- "Organic eggs" → Still contains animal ingredients (High confidence)
- "Cage-free milk" → Still contains animal ingredients (High confidence)
- "Pasture-raised chicken" → Still contains animal ingredients (High confidence)

**Rule:** Production method labels do NOT change ingredient classification. Animal-derived ingredients remain animal-derived regardless of welfare standards.

---

### Cultured/Cultivated Meat

**Definition:** Meat grown from animal cells without raising and slaughtering animals.

**Current Status:**
- Not yet widely available commercially
- Still technically animal-derived (uses animal cells)
- Does not involve live-animal slaughter

**Classification:**
- Animal-derived at cellular level
- But represents different ethical category (no sentient animal harmed)

**Future Consideration:** May require separate classification category as technology becomes available.

---

### Fermentation-Derived Ingredients

**Precision Fermentation Products:**
- Whey protein produced via fermentation (not from dairy cows)
- Casein produced via fermentation
- Heme protein (used in Impossible Foods) from fermentation

**Classification:**
- NOT animal-derived (no animal involved in production)
- Molecularly identical to animal-derived version, but produced differently

**Communication:**
- Clarify: "This product uses fermentation-derived proteins, not animal-derived"
- Note: "No animals involved in production"

---

## User-Provided Information

### Rule: User is Authoritative

**When user explicitly states ingredient information:**
- Trust user over visual analysis
- Set confidence to "High" for user-stated ingredients
- Update hasAnimalIngredients accordingly

**Examples:**
- User: "This soup contains sausage and eggs" → Set hasAnimalIngredients = true, list sausage and eggs (High confidence)
- User: "This is actually vegan cheese" → Set hasAnimalIngredients = false (High confidence)

**Exception:** If user provides production method context (e.g., "cage-free"), this does NOT change ingredient classification. Cage-free eggs are still eggs.

---

## Output Requirements

### Required Fields

**When animal ingredients are detected:**
```json
{
  "hasAnimalIngredients": true,
  "animalIngredients": {
    "value": "List of specific animal-derived ingredients (e.g., 'Chicken, eggs, cheese')",
    "confidence": "High" | "Medium" | "Low"
  }
}
```

**When NO animal ingredients are detected:**
```json
{
  "hasAnimalIngredients": false,
  "animalIngredients": {
    "value": "None detected",
    "confidence": "High" | "Medium" | "Low"
  }
}
```

### Language Requirements

**When product explicitly states animal ingredients:**
- Use definitive language: "This product CONTAINS animal-derived ingredients"
- Never hedge: "likely contains", "may contain", "appears to contain"

**When inferring ingredients:**
- Use cautious language: "likely contains", "typically contains"
- Acknowledge uncertainty

---

## Implementation Notes

**Code Location:**
- Defined in `supabase/functions/_shared/prompt-loader.ts` (prompts)
- Applied in `supabase/functions/analyze-image/index.ts`

---

## Review and Updates

**Review Frequency:**
- Annually or when new product categories emerge
- When fermentation/cultivated products become mainstream
- When user feedback indicates misclassification
- When scientific consensus on classification changes

**Update Process:**
1. Propose changes with scientific rationale
2. Review by food science/welfare science team
3. Update classification criteria and prompts
4. Document version change
5. Test updated criteria on sample products

---

## Version History

| Version | Date | Changes | Reviewer |
|---------|------|---------|----------|
| 1.0 | 2025-01-21 | Initial classification criteria | - |

---

## Related Documentation

- `prompts/confidence_level_guidelines.md` - Confidence in ingredient detection
- `prompts/analyze_product.txt` - Product analysis prompt
- `prompts/detect_items.txt` - Multi-item detection prompt

---

## Notes for Scientists

This classification system should be reviewed for:

1. **Accuracy:** Are ingredient categories scientifically correct and comprehensive?
2. **Boundary Cases:** Are edge cases (fermentation, cultured meat) handled appropriately?
3. **Future-Proofing:** Will these criteria adapt as food technology evolves?
4. **User Clarity:** Will users understand what counts as animal-derived?
5. **Ethical Alignment:** Do classifications align with welfare footprint mission?

**Key Questions:**
- Should trace ingredients be weighted differently in welfare impact?
- How should emerging technologies (fermentation, cultured meat) be classified?
- Are there missing ingredient categories?

**Feedback:** Direct scientific feedback to the research team for criteria refinement.
